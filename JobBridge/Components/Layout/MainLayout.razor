@inherits LayoutComponentBase
@using Microsoft.AspNetCore.Components.Authorization
@using System.Security.Claims
@inject SessionAuthService SessionAuth
@inject IJSRuntime JSRuntime

<div class="page-layout-horizontal">
    <header class="top-navbar-container" role="banner">
        <NavMenu />
    </header>

    <AuthorizeView>
        <Authorized>
            <div class="welcome-message bg-light border-bottom py-2" role="status" aria-live="polite">
                <div class="container">
                    <div style="color: #157045; font-size: 1.15rem;" class="text-center ">
                        <i class="bi bi-check-circle-fill me-2" aria-hidden="true"></i>
                        <span aria-label="Welcome back, @context.User.FindFirst(ClaimTypes.GivenName)?.Value">
                            Welcome back, <strong>@context.User.FindFirst(ClaimTypes.GivenName)?.Value</strong>! 
                        </span>
                        <span class="text-muted d-block d-md-inline-block">
                            You are logged in as @context.User.FindFirst("http://schemas.microsoft.com/ws/2008/06/identity/claims/role")?.Value
                        </span>
                    </div>
                </div>
            </div>
        </Authorized>
    </AuthorizeView>

    <main id="mainContent" class="main-content-horizontal" tabindex="-1">
        <article class="content px-4">
            @Body
        </article>
    </main>

    <Footer />
</div>

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await SessionAuth.InitializeAsync(JSRuntime);
        }
    }
}


<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">🗙</span>
</div>